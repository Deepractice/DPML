# DPML 语义规范 v1.0

## 文档元数据

- **版本**: 1.0.0
- **状态**: Draft
- **最后更新**: 2025-10-04
- **作者**: 姜山 (Deepractice.ai)
- **语言**: 中文
- **英文版本**: [semantics.en.md](./semantics.en.md)

---

## 摘要

本文档定义 DPML (Deepractice Prompt Markup Language) 的语义规范，规定标签、属性、内容和结构的语义表达规则。

本规范是 [DPML 协议规范](./index.zh-CN.md) 的语义部分，与 [语法规范](./syntax.zh-CN.md) 共同构成完整的 DPML 协议。

---

## 1. 引言

### 1.1 范围

本规范定义：
- 标签的语义表达规则
- 属性的语义约定
- 内容的类型系统
- 结构的语义组合规则

本规范不定义：
- XML 语法规则（见语法规范）
- 具体领域的标签定义（见 Patterns）
- 实现技术细节

### 1.2 规范性语言

本文档中的关键词 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", "OPTIONAL" 应按照 RFC 2119 的定义解释。

### 1.3 与其他规范的关系

```
DPML 协议规范
├── 语法规范 (Syntax)    - 定义格式和解析规则 (MUST)
└── 语义规范 (Semantics) - 定义语义表达规则 (SHOULD)
```

语义规范是**指导性的** (SHOULD)，不是**强制性的** (MUST)。实现可以根据领域需求调整。

---

## 2. 术语定义

### 2.1 核心术语

**标签 (Tag)**
: XML 元素的名称，表示一个概念或实体。

**属性 (Attribute)**
: 附加在标签上的元数据，提供技术性或配置性信息。

**内容 (Content)**
: 标签包含的实际数据或文本。

**语义 (Semantics)**
: 标签、属性、内容和结构所传达的含义。

**概念 (Concept)**
: 可以被定义、理解和传递的抽象实体。

**认知框架 (Cognitive Framework)**
: 由 DPML 标签组成的结构，用于引导 AI 的内容生成和组织。

### 2.2 设计原则术语

**标签即概念**
: 标签必须表示概念，因此必须是名词。

**约而不束**
: 标签框定内容的语义性质，但不限制具体内容的表达。

**语义正交**
: 不同标签的语义互不重叠，边界清晰。

---

## 3. 语义模型

### 3.1 四维语义

DPML 的语义通过四个维度表达：

1. **标签语义** - 标签名称表达的概念
2. **属性语义** - 属性提供的元数据
3. **内容语义** - 内容承载的信息
4. **结构语义** - 嵌套和顺序传递的关系

这四个维度共同构成完整的语义表达。

### 3.2 语义层次

```
抽象层: 标签定义"是什么"(概念)
      ↓
表达层: type 定义"怎么表达"(格式)
      ↓
内容层: 具体的信息内容
```

---

## 4. 标签语义规范

### 4.1 标签词性要求

标签 MUST 是名词。

**理论依据:**
- 概念是可定义、可理解、可传递的抽象实体
- 名词是概念在自然语言中的载体
- 动词和形容词描述关系或属性，本身不构成独立概念

**因此:**
- 动词 MUST 名词化后使用（如：validate → validation）
- 形容词 MUST 转换为名词或使用属性（如：required → requirement 或 requirement="true"）

### 4.2 标签命名规范

标签名称 MUST 使用 kebab-case（短横线分隔）。

标签名称 SHOULD 满足：
- 长度：1-3 个单词
- 语义：清晰且自解释
- 通用性：优先使用领域通用术语

标签名称 SHOULD NOT 使用缩写，除非是广泛认可的术语（如 id, url）。

### 4.3 标签单复数规范

标签 SHOULD 使用单数形式。

**理由:** XML 原生支持元素重复，无需通过复数标记表达数量。

**例外:** 当复数形式本身具有独立语义时 MAY 使用复数（如 dependencies vs dependency）。

---

## 5. 属性语义规范

### 5.1 属性的性质

属性主要面向计算机处理，提供元数据和技术约束。

属性不受标签词性约束的限制。属性的命名和语义 SHOULD 由领域自定义。

### 5.2 保留属性

协议定义以下保留属性：

**type**
: 指定内容的表达格式（见 6.1 内容类型系统）。

**id**
: 元素的唯一标识符（见语法规范）。

领域定义的属性 SHOULD NOT 与保留属性冲突。

### 5.3 属性 vs 子元素

元数据性质的信息 SHOULD 使用属性。
语义核心内容 SHOULD 使用子元素。

---

## 6. 内容语义规范

### 6.1 内容类型系统

#### 6.1.1 type 属性

标签 MAY 使用 `type` 属性指定内容的表达格式。

`type` 属性的设计目的：
- 当需要复杂表达时，避免创造过度嵌套的标签结构
- 允许使用成熟的 DSL（领域特定语言）表达复杂内容
- 保持标签语义的纯粹性

#### 6.1.2 标准 type 值

v1.0 定义以下标准 type 值：

| type 值 | 语义 |
|---------|------|
| text | 纯文本或自然语言（默认） |
| markdown | Markdown 格式文本 |

未指定 `type` 属性时，默认为 `type="text"`。

#### 6.1.3 type 值的扩展

实现 MAY 定义额外的 type 值以支持特定格式（如 json, python, yaml）。

自定义 type 值 SHOULD 直接使用格式名称或语言名称，不使用中间抽象层。

**示例:**
- 正确：`type="python"`
- 不推荐：`type="code" language="python"`

#### 6.1.4 type 的嵌套限制

v1.0 不支持嵌套的 type 定义。一个元素只能有一个 type 值。

包含不同格式内容时，SHOULD 使用父级 type 的语法特性（如 markdown 的代码块）。

### 6.2 语义框定原则

标签 SHOULD 框定内容的**性质**，而非内容本身。

**"约而不束"的实现:**
- 约：通过标签名称框定内容应该是什么性质的信息
- 不束：不限制具体内容的表达方式和创造性

---

## 7. 结构语义规范

### 7.1 嵌套语义

标签的嵌套关系表达"包含"或"属于"的语义关系。

子元素 SHOULD 语义上属于父元素。

### 7.2 顺序语义

元素的顺序 MAY 具有语义（如流程步骤）或 MAY 仅为组织目的。

当顺序具有语义时，SHOULD 通过元素名称或属性明确表达。

### 7.3 语义正交性

同一层次的元素 SHOULD 语义正交（互不重叠）。

---

## 8. 认知框架

### 8.1 定义

认知框架是由 DPML 标签组成的结构，用于引导 AI 的内容生成和思维组织。

### 8.2 框架特性

认知框架：
- 通过标签框定"应该生成什么性质的内容"
- 不限制具体内容本身
- 是可复制的模式（Pattern）

### 8.3 框架完备性

认知框架 SHOULD 覆盖目标认知过程的所有关键维度。

框架内的元素 SHOULD 语义正交且层次清晰。

---

## 9. 一致性要求

### 9.1 符合性级别

**完全符合 (Full Conformance)**
: 标签遵循所有 MUST 要求，并遵循大部分 SHOULD 建议。

**基本符合 (Basic Conformance)**
: 标签遵循所有 MUST 要求。

**不符合 (Non-Conformance)**
: 标签违反任何 MUST 要求。

### 9.2 验证

语义符合性 MAY 通过以下方式验证：
- 人工审查
- 自动化语义分析工具
- Pattern 定义的具体规则

---

## 10. 扩展机制

### 10.1 自定义标签

实现 MAY 定义领域特定的标签。

自定义标签 MUST 遵循本规范的标签语义要求（第 4 节）。

自定义标签 SHOULD 通过 Pattern 定义其语义和用法。

### 10.2 自定义属性

实现 MAY 定义领域特定的属性。

自定义属性 SHOULD NOT 与保留属性冲突。

### 10.3 自定义 type 值

实现 MAY 定义额外的 type 值。

自定义 type 值 SHOULD 有明确的格式定义和处理规范。

---

## 11. 参考文献

### 11.1 规范性引用

**[RFC2119]**
Bradner, S.,
"Key words for use in RFCs to Indicate Requirement Levels",
BCP 14, RFC 2119, March 1997.
https://www.rfc-editor.org/rfc/rfc2119

### 11.2 信息性引用

**[DPML-PROTOCOL]**
Jiang, S.,
"DPML 协议规范总览",
Deepractice.ai, October 2025.
./index.zh-CN.md

**[DPML-SYNTAX]**
Jiang, S.,
"DPML 语法规范",
Deepractice.ai, October 2025.
./syntax.zh-CN.md

**[DPML-WHITEPAPER]**
Jiang, S.,
"DPML 设计白皮书",
Deepractice.ai, October 2025.
../whitepaper/index.zh-CN.md

**[PATTERN-META]**
Jiang, S.,
"Meta-Pattern: 模式定义的模式",
Deepractice.ai, October 2025.
../patterns/meta/pattern.dpml

---

## 附录 A: 术语索引

| 术语 | 定义位置 |
|------|---------|
| 标签 (Tag) | 2.1 |
| 属性 (Attribute) | 2.1 |
| 内容 (Content) | 2.1 |
| 语义 (Semantics) | 2.1 |
| 概念 (Concept) | 2.1 |
| 认知框架 (Cognitive Framework) | 2.1, 8.1 |
| 标签即概念 | 2.2, 4.1 |
| 约而不束 | 2.2, 6.2 |
| 语义正交 | 2.2, 7.3 |
| 四维语义 | 3.1 |

---

**版本历史:**
- v1.0.0 (2025-10-04) - 初始版本
